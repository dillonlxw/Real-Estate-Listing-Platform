<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Properties</title>
  <link rel="stylesheet" th:href="@{/css/properties.css}" />
</head>
<body>
    <div class="decorative-box">
        <!-- Navigation Bar -->
        <nav>
            <div class="nav-left">
            <div class="logo">
                <span class="logo-circle"></span>
                <a th:href="@{/}" class="company-text-link">
                    <span class="company-text">Spring Real Estate</span>
                </a>
            </div>
            </div>
            <div class="nav-right">
            <ul class="nav-links">
                <li><a th:href="@{/}">Home</a></li>
                <li><a th:href="@{/properties}" class="active-link">Properties</a></li>
                <li><a th:href="@{/about}">About us</a></li>
            </ul>
            </div>
        </nav>
        <!-- Properties content -->
        <div class="page-container">
            <div class="properties-wrapper">
                <div class="properties-header">
                    <h1 th:text="${propertiesMessage}">Properties</h1>
                    <div class="action-buttons">
                        <a class="action-button select-button" onclick="showPopup()">Filter</a>
                        <div id="popup" class="popup">
                            <div class="popup-content">
                                <span class="close-button" onclick="hidePopup()">&times;</span>
                                <h2>Filter Property</h2>
                                <p>Filter Property Placeholder</p> <!-- TODO: Implement filter form -->
                            </div>
                        </div>
                        <a class="action-button add-button" onclick="showAddPropertyPopup()">Add Property</a>
                        <div id="addPropertyPopup" class="popup">
                            <div class="popup-content">
                                <span class="close-button" onclick="hideAddPropertyPopup()">&times;</span>
                                <h2>Add New Property</h2>
                                <p>Add Property Placeholder</p> <!-- TODO: Implement add form -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="properties-table-container">
                    <table class="properties-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Property Name</th>
                                <th>Address</th>
                                <th>Price</th>
                                <th>Type</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Iterate over properties -->
                            <tr th:if="${properties.isEmpty()}">
                                <td colspan="6" style="text-align: center;">No properties available.</td>
                            </tr>
                            <tr th:each="property : ${properties}">
                                <td th:text="${property.id}">1</td>
                                <td th:text="${property.propertyName}">Modern Apartment</td>
                                <td th:text="${property.address}">123 Main St, City</td>
                                <td th:text="${#numbers.formatCurrency(property.price)}">$350,000</td>
                                <td th:text="${property.type}">Apartment</td>
                                <td th:text="${property.status}">For Sale</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="bg-image"></div>
        </div>
    </div>
<script>
    // Show/hide filter popup
    function showPopup() {
        document.getElementById("popup").style.display = "block";
    }
    function hidePopup() {
        document.getElementById("popup").style.display = "none";
    }

    // Show/hide add property popup
    function showAddPropertyPopup() {
        document.getElementById("addPropertyPopup").style.display = "block";
    }
    function hideAddPropertyPopup() {
        document.getElementById("addPropertyPopup").style.display = "none";
    }

    // Close popups when clicking outside
    document.addEventListener('click', function(event) {
        const popups = ['popup', 'addPropertyPopup'];
        popups.forEach(popupId => {
            const popup = document.getElementById(popupId);
            if (popup) { // Check if popup element exists
                const popupContent = popup.querySelector('.popup-content');
                 if (popup.style.display === "block" && 
                    popupContent && !popupContent.contains(event.target) && 
                    !event.target.classList.contains('select-button') && 
                    !event.target.classList.contains('add-button')) {
                    popup.style.display = "none";
                }
            }
        });
    });
</script>
</body>
</html>
